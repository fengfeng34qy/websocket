(function(e,r){"object"==typeof exports?module.exports=exports=r(require("./core")):"function"==typeof define&&define.amd?define(["./core"],r):r(e.CryptoJS)})(this,function(e){e.lib.Cipher||function(r){var t=e,i=t.lib,o=i.Base,n=i.WordArray,c=i.BufferedBlockAlgorithm,s=t.enc;s.Utf8;var a=s.Base64,f=t.algo,u=f.EvpKDF,h=i.Cipher=c.extend({cfg:o.extend(),createEncryptor:function(e,r){return this.create(this._ENC_XFORM_MODE,e,r)},createDecryptor:function(e,r){return this.create(this._DEC_XFORM_MODE,e,r)},init:function(e,r,t){this.cfg=this.cfg.extend(t),this._xformMode=e,this._key=r,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var r=this._doFinalize();return r},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?B:g}return function(r){return{encrypt:function(t,i,o){return e(i).encrypt(r,t,i,o)},decrypt:function(t,i,o){return e(i).decrypt(r,t,i,o)}}}}()});i.StreamCipher=h.extend({_doFinalize:function(){var e=this._process(true);return e},blockSize:1});var p=t.mode={},d=i.BlockCipherMode=o.extend({createEncryptor:function(e,r){return this.Encryptor.create(e,r)},createDecryptor:function(e,r){return this.Decryptor.create(e,r)},init:function(e,r){this._cipher=e,this._iv=r}}),l=p.CBC=function(){function e(e,t,i){var o=this._iv;if(o){var n=o;this._iv=r}else var n=this._prevBlock;for(var c=0;i>c;c++)e[t+c]^=n[c]}var t=d.extend();return t.Encryptor=t.extend({processBlock:function(r,t){var i=this._cipher,o=i.blockSize;e.call(this,r,t,o),i.encryptBlock(r,t),this._prevBlock=r.slice(t,t+o)}}),t.Decryptor=t.extend({processBlock:function(r,t){var i=this._cipher,o=i.blockSize,n=r.slice(t,t+o);i.decryptBlock(r,t),e.call(this,r,t,o),this._prevBlock=n}}),t}(),y=t.pad={},v=y.Pkcs7={pad:function(e,r){for(var t=4*r,i=t-e.sigBytes%t,o=i<<24|i<<16|i<<8|i,c=[],s=0;i>s;s+=4)c.push(o);var a=n.create(c,i);e.concat(a)},unpad:function(e){var r=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=r}};i.BlockCipher=h.extend({cfg:h.cfg.extend({mode:l,padding:v}),reset:function(){h.reset.call(this);var e=this.cfg,r=e.iv,t=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=t.createEncryptor;else{var i=t.createDecryptor;this._minBufferSize=1}this._mode=i.call(t,this,r&&r.words)},_doProcessBlock:function(e,r){this._mode.processBlock(e,r)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var r=this._process(true)}else{var r=this._process(true);e.unpad(r)}return r},blockSize:4});var _=i.CipherParams=o.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),m=t.format={},x=m.OpenSSL={stringify:function(e){var r=e.ciphertext,t=e.salt;if(t)var i=n.create([1398893684,1701076831]).concat(t).concat(r);else var i=r;return i.toString(a)},parse:function(e){var r=a.parse(e),t=r.words;if(1398893684==t[0]&&1701076831==t[1]){var i=n.create(t.slice(2,4));t.splice(0,4),r.sigBytes-=16}return _.create({ciphertext:r,salt:i})}},g=i.SerializableCipher=o.extend({cfg:o.extend({format:x}),encrypt:function(e,r,t,i){i=this.cfg.extend(i);var o=e.createEncryptor(t,i),n=o.finalize(r),c=o.cfg;return _.create({ciphertext:n,key:t,iv:c.iv,algorithm:e,mode:c.mode,padding:c.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,r,t,i){i=this.cfg.extend(i),r=this._parse(r,i.format);var o=e.createDecryptor(t,i).finalize(r.ciphertext);return o},_parse:function(e,r){return"string"==typeof e?r.parse(e,this):e}}),S=t.kdf={},w=S.OpenSSL={execute:function(e,r,t,i){i||(i=n.random(8));var o=u.create({keySize:r+t}).compute(e,i),c=n.create(o.words.slice(r),4*t);return o.sigBytes=4*r,_.create({key:o,iv:c,salt:i})}},B=i.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:w}),encrypt:function(e,r,t,i){i=this.cfg.extend(i);var o=i.kdf.execute(t,e.keySize,e.ivSize);i.iv=o.iv;var n=g.encrypt.call(this,e,r,o.key,i);return n.mixIn(o),n},decrypt:function(e,r,t,i){i=this.cfg.extend(i),r=this._parse(r,i.format);var o=i.kdf.execute(t,e.keySize,e.ivSize,r.salt);i.iv=o.iv;var n=g.decrypt.call(this,e,r,o.key,i);return n}})}()});